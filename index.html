<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã¯ã˜ã‚ã¦ã®ãˆã„ã”</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@700;800&display=swap');

        :root {
            --bg-color: #fdf0d5; 
            --primary-color: #48cae4;
            --secondary-color: #ff6b6b;
            --accent-color: #f9c74f;
            --text-color: #3d405b;
            --white: #ffffff;
        }
        html, body {
            margin: 0;
            font-family: 'M PLUS Rounded 1c', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            -webkit-tap-highlight-color: transparent;
        }
        /* ã€ä¿®æ­£ã€‘ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ã«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’èª¿æ•´ */
        .screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            min-height: 100vh; /* ç”»é¢ãŒçŸ­ãã¦ã‚‚é«˜ã•ã‚’ç¢ºä¿ */
            box-sizing: border-box;
            padding: 20px 10px;
        }
        #flashcard-screen {
             justify-content: center; /* ã‚«ãƒ¼ãƒ‰ç”»é¢ã¯ä¸­å¤®æƒãˆã‚’ç¶­æŒ */
        }
        .hidden { display: none; }
        h1 { font-size: 2.5rem; font-weight: 800; color: var(--primary-color); margin: 0 0 1rem 0; }
        
        button {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            font-weight: 700; font-size: 1.3rem; padding: 15px 24px;
            border-radius: 50px; border: none; cursor: pointer;
            color: var(--text-color); margin-top: 10px;
            transition: transform 0.1s ease, box-shadow 0.1s ease;
            box-shadow: 0 5px 0 #d4a373;
        }
        button:active {
            transform: translateY(3px);
            box-shadow: 0 2px 0 #d4a373;
        }
        
        /* ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ */
        #mode-selection { background: #fff; border-radius: 10px; padding: 10px; margin-bottom: 1.5rem; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        #mode-selection label { font-size: 1.1rem; margin: 0 10px; }
        #category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
            gap: 15px; width: 100%; max-width: 500px;
            margin-bottom: 1.5rem;
        }
        .category-button {
            font-size: 1rem; font-weight: bold;
            padding: 12px 5px; border-radius: 15px;
            color: white;
        }
        /* ã‚«ãƒ†ã‚´ãƒªãƒ¼ã®è‰²åˆ†ã‘ */
        .cat-animals { background-color: #28a745; } .cat-foods { background-color: #dc3545; }
        .cat-colors { background-color: #fd7e14; } .cat-numbers { background-color: #17a2b8; }
        .cat-school { background-color: #6f42c1; } .cat-actions { background-color: #ff69b4; }
        .cat-body { background-color: #e83e8c; } .cat-family { background-color: #20c997; }
        .cat-nature { background-color: #007bff; } .cat-clothes { background-color: #6610f2; }
        .cat-shapes { background-color: #ff4757; } .cat-adjectives { background-color: #343a40; }
        .cat-vehicles { background-color: #6c757d; } .cat-jobs { background-color: #198754; }
        .cat-places { background-color: #fd7e14; } .cat-insects { background-color: #d63384; }
        .cat-vegetables { background-color: #28a745; } .cat-sports { background-color: #0d6efd; }
        .cat-instruments { background-color: #8f7763; } .cat-stationery { background-color: #6f42c1; }
        .cat-days { background-color: #ffc107; } .cat-weather { background-color: #48cae4; }
        .cat-countries { background-color: #0dcaf0; } .cat-seasons { background-color: #dc3545; }

        /* ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ç”»é¢ */
        .card-container {
            perspective: 1000px;
            width: 90vw; max-width: 350px;
            height: 70vw; max-height: 280px;
            margin-top: 1rem;
        }
        .card { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform 0.6s; }
        .card.manual-mode { cursor: pointer; }
        .card.is-flipped { transform: rotateY(180deg); }
        .card-face {
            position: absolute; width: 100%; height: 100%;
            backface-visibility: hidden; border-radius: 20px;
            background: var(--white); box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
        }
        .card-face-back { transform: rotateY(180deg); }
        .card-emoji { font-size: 5rem; }
        .card-text { font-size: 2.5rem; font-weight: bold; }
        
        .nav-buttons { display: flex; justify-content: center; gap: 20px; width: 100%; max-width: 400px; margin-top: 2rem; }
        .nav-buttons button { background-color: var(--secondary-color); width: 150px; margin-top: 0; }
        .play-pause-button { background-color: var(--accent-color); }
        
        @media (max-width: 480px) {
            h1 { font-size: 2.2rem; }
            .card-emoji { font-size: 4rem; }
            .card-text { font-size: 2rem; }
            .nav-buttons button { width: 130px; }
        }
    </style>
</head>
<body>

    <div id="category-screen" class="screen">
        <h1>ã¯ã˜ã‚ã¦ã®ãˆã„ã”</h1>
        <div id="mode-selection">
            <label><input type="radio" name="mode" value="manual" checked> ã‚¿ãƒƒãƒ—ã§ã¹ã‚“ãã‚‡ã†</label>
            <label><input type="radio" name="mode" value="auto"> è‡ªå‹•ã§ãã</label>
        </div>
        <div id="category-grid">
            <button class="category-button cat-animals" data-category="animals">ã©ã†ã¶ã¤ ğŸ¦</button>
            <button class="category-button cat-foods" data-category="foods">ãŸã¹ã‚‚ã® ğŸ“</button>
            <button class="category-button cat-vegetables" data-category="vegetables">ã‚„ã•ã„ ğŸ¥•</button>
            <button class="category-button cat-colors" data-category="colors">ã„ã‚ ğŸ¨</button>
            <button class="category-button cat-numbers" data-category="numbers">ã‹ãš ğŸ”¢</button>
            <button class="category-button cat-shapes" data-category="shapes">ã‹ãŸã¡ â­</button>
            <button class="category-button cat-actions" data-category="actions">ã†ã”ã ğŸ’ª</button>
            <button class="category-button cat-adjectives" data-category="adjectives">ã‚ˆã†ã™ âœ¨</button>
            <button class="category-button cat-body" data-category="body">ã‹ã‚‰ã  ğŸ‘€</button>
            <button class="category-button cat-family" data-category="family">ã‹ãã ğŸ‘¨â€ğŸ‘©â€ğŸ‘§</button>
            <button class="category-button cat-nature" data-category="nature">ã—ãœã‚“ ğŸŒ³</button>
            <button class="category-button cat-weather" data-category="weather">ã¦ã‚“ã â˜€ï¸</button>
            <button class="category-button cat-clothes" data-category="clothes">ãµã ğŸ‘•</button>
            <button class="category-button cat-school" data-category="school">ãŒã£ã“ã† ğŸ«</button>
            <button class="category-button cat-stationery" data-category="stationery">ã¶ã‚“ã¼ã†ã âœï¸</button>
            <button class="category-button cat-vehicles" data-category="vehicles">ã®ã‚Šã‚‚ã® ğŸš—</button>
            <button class="category-button cat-places" data-category="places">ã°ã—ã‚‡ ğŸ—¼</button>
            <button class="category-button cat-jobs" data-category="jobs">ãŠã—ã”ã¨ ğŸ§‘â€âš•ï¸</button>
            <button class="category-button cat-insects" data-category="insects">ã‚€ã— ğŸ</button>
            <button class="category-button cat-sports" data-category="sports">ã‚¹ãƒãƒ¼ãƒ„ âš½</button>
            <button class="category-button cat-instruments" data-category="instruments">ãŒã£ã ğŸ¹</button>
            <button class="category-button cat-days" data-category="days">ã‚ˆã†ã³ ğŸ“…</button>
            <button class="category-button cat-seasons" data-category="seasons">ãã›ã¤ ğŸŒ¸</button>
            <button class="category-button cat-countries" data-category="countries">ãã« ğŸ‡¯ğŸ‡µ</button>
            <button class="category-button cat-directions" data-category="directions">ã»ã†ã“ã† ğŸ§­</button>
        </div>
        </div>

    <div id="flashcard-screen" class="screen hidden">
        <div class="card-container">
            <div id="card" class="card">
                <div class="card-face card-face-front">
                    <div id="front-emoji" class="card-emoji"></div>
                    <div id="front-text" class="card-text"></div>
                </div>
                <div class="card-face card-face-back">
                    <div id="back-text" class="card-text"></div>
                </div>
            </div>
        </div>
        <div class="nav-buttons">
            <button class="back-button">ã‚‚ã©ã‚‹</button>
            <button id="next-card" class="nav-button">ã¤ãã¸</button>
            <button id="play-pause-button" class="play-pause-button nav-button hidden">ã„ã¡ã˜ã¦ã„ã—</button>
        </div>
    </div>
    
    <script>
        // --- å˜èªãƒ‡ãƒ¼ã‚¿ (é•·ã„ã®ã§çœç•¥) ---
        const wordData={animals:[{emoji:"ğŸ¶",en:"dog",ja:"ã„ã¬"},{emoji:"ğŸ±",en:"cat",ja:"ã­ã“"},{emoji:"ğŸ°",en:"rabbit",ja:"ã†ã•ã"},{emoji:"ğŸ¦",en:"lion",ja:"ãƒ©ã‚¤ã‚ªãƒ³"},{emoji:"ğŸ˜",en:"elephant",ja:"ãã†"},{emoji:"ğŸµ",en:"monkey",ja:"ã•ã‚‹"},{emoji:"ğŸ¼",en:"panda",ja:"ãƒ‘ãƒ³ãƒ€"},{emoji:"ğŸ¦",en:"bird",ja:"ã¨ã‚Š"},{emoji:"ğŸ­",en:"mouse",ja:"ã­ãšã¿"},{emoji:"ğŸ»",en:"bear",ja:"ãã¾"},{emoji:"ğŸ·",en:"pig",ja:"ã¶ãŸ"},{emoji:"ğŸŸ",en:"fish",ja:"ã•ã‹ãª"},{emoji:"ğŸ´",en:"horse",ja:"ã†ã¾"},{emoji:"ğŸ¦’",en:"giraffe",ja:"ãã‚Šã‚“"},{emoji:"ğŸ‘",en:"sheep",ja:"ã²ã¤ã˜"},{emoji:"ğŸ¢",en:"turtle",ja:"ã‹ã‚"}],foods:[{emoji:"ğŸ",en:"apple",ja:"ã‚Šã‚“ã”"},{emoji:"ğŸ“",en:"strawberry",ja:"ã„ã¡ã”"},{emoji:"ğŸŠ",en:"orange",ja:"ã¿ã‹ã‚“"},{emoji:"ğŸ‡",en:"grape",ja:"ã¶ã©ã†"},{emoji:"ğŸŒ",en:"banana",ja:"ãƒãƒŠãƒŠ"},{emoji:"ğŸ‰",en:"watermelon",ja:"ã™ã„ã‹"},{emoji:"ğŸ‘",en:"peach",ja:"ã‚‚ã‚‚"},{emoji:"ğŸ’",en:"cherry",ja:"ã•ãã‚‰ã‚“ã¼"},{emoji:"ğŸ",en:"bread",ja:"ãƒ‘ãƒ³"},{emoji:"ğŸš",en:"rice",ja:"ã”ã¯ã‚“"},{emoji:"ğŸ¥›",en:"milk",ja:"ãã‚…ã†ã«ã‚…ã†"},{emoji:"ğŸ°",en:"cake",ja:"ã‚±ãƒ¼ã‚­"},{emoji:"ğŸ¥š",en:"egg",ja:"ãŸã¾ã”"},{emoji:"ğŸ§€",en:"cheese",ja:"ãƒãƒ¼ã‚º"},{emoji:"ğŸ¦",en:"ice cream",ja:"ã‚¢ã‚¤ã‚¹"}],vegetables:[{emoji:"ğŸ¥•",en:"carrot",ja:"ã«ã‚“ã˜ã‚“"},{emoji:"ğŸ…",en:"tomato",ja:"ãƒˆãƒãƒˆ"},{emoji:"ğŸ¥”",en:"potato",ja:"ã˜ã‚ƒãŒã„ã‚‚"},{emoji:"ğŸ¥’",en:"cucumber",ja:"ãã‚…ã†ã‚Š"},{emoji:"ğŸ§…",en:"onion",ja:"ãŸã¾ã­ã"},{emoji:"ğŸŒ½",en:"corn",ja:"ã¨ã†ã‚‚ã‚ã“ã—"}],colors:[{emoji:"ğŸ”´",en:"red",ja:"ã‚ã‹"},{emoji:"ğŸ”µ",en:"blue",ja:"ã‚ãŠ"},{emoji:"ğŸŸ¡",en:"yellow",ja:"ãã„ã‚"},{emoji:"ğŸŸ¢",en:"green",ja:"ã¿ã©ã‚Š"},{emoji:"âš«ï¸",en:"black",ja:"ãã‚"},{emoji:"âšªï¸",en:"white",ja:"ã—ã‚"},{emoji:"ğŸ©·",en:"pink",ja:"ãƒ”ãƒ³ã‚¯"},{emoji:"ğŸ§¡",en:"orange",ja:"ã‚ªãƒ¬ãƒ³ã‚¸"},{emoji:"ğŸŸ£",en:"purple",ja:"ã‚€ã‚‰ã•ã"},{emoji:"ğŸŸ¤",en:"brown",ja:"ã¡ã‚ƒã„ã‚"}],numbers:function(){const t=[];for(let n=0;n<=100;n++)t.push({emoji:String(n),en:((t,e)=>{if(t<0||t>100)return"";const n=["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],o=["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"];return t<20?n[t]:100===t?"one hundred":o[Math.floor(t/10)]+(t%10>0?"-"+n[t%10]:"")})(n),ja:((t,e)=>{if(t>100)return String(t);if(0===t)return"ã‚Œã„";const n=["","ã„ã¡","ã«","ã•ã‚“","ã‚ˆã‚“","ã”","ã‚ã","ãªãª","ã¯ã¡","ãã‚…ã†"],o=["","ã˜ã‚…ã†","ã«ã˜ã‚…ã†","ã•ã‚“ã˜ã‚…ã†","ã‚ˆã‚“ã˜ã‚…ã†","ã”ã˜ã‚…ã†","ã‚ãã˜ã‚…ã†","ãªãªã˜ã‚…ã†","ã¯ã¡ã˜ã‚…ã†","ãã‚…ã†ã˜ã‚…ã†"];if(t<10)return n[t];if(10===t)return"ã˜ã‚…ã†";if(t<100){const e=Math.floor(t/10),a=t%10;let r=1===e?"ã˜ã‚…ã†":o[e];return r+=n[a],r}return 100===t?"ã²ã‚ƒã":void 0})(n)});return t}(),shapes:[{emoji:"â¤ï¸",en:"heart",ja:"ãƒãƒ¼ãƒˆ"},{emoji:"â­",en:"star",ja:"ã»ã—"},{emoji:"â­•",en:"circle",ja:"ã¾ã‚‹"},{emoji:"âŒ",en:"cross",ja:"ã°ã¤"},{emoji:"ğŸ”¼",en:"triangle",ja:"ã•ã‚“ã‹ã"},{emoji:"â¹ï¸",en:"square",ja:"ã—ã‹ã"}],school:[{emoji:"ğŸ«",en:"school",ja:"ãŒã£ã“ã†"},{emoji:"ğŸ“–",en:"book",ja:"ã»ã‚“"},{emoji:"ğŸ’",en:"bag",ja:"ã‹ã°ã‚“"},{emoji:"ğŸ§‘â€ğŸ«",en:"teacher",ja:"ã›ã‚“ã›ã„"},{emoji:"ğŸ§‘â€ğŸ“",en:"student",ja:"ã›ã„ã¨"},{emoji:"æ¤…å­",en:"chair",ja:"ã„ã™"},{emoji:"æœº",en:"desk",ja:"ã¤ããˆ"}],stationery:[{emoji:"âœï¸",en:"pencil",ja:"ãˆã‚“ã´ã¤"},{emoji:"âœ’ï¸",en:"pen",ja:"ãƒšãƒ³"},{emoji:"Crayon",en:"crayon",ja:"ã‚¯ãƒ¬ãƒ¨ãƒ³"},{emoji:"âœ‚ï¸",en:"scissors",ja:"ã¯ã•ã¿"},{emoji:"ğŸ“",en:"ruler",ja:"ã‚‚ã®ã•ã—"},{emoji:"ãƒãƒ¼ãƒˆ",en:"notebook",ja:"ãƒãƒ¼ãƒˆ"}],actions:[{emoji:"ğŸƒ",en:"run",ja:"ã¯ã—ã‚‹"},{emoji:"ğŸš¶",en:"walk",ja:"ã‚ã‚‹ã"},{emoji:"âœˆï¸",en:"fly",ja:"ã¨ã¶"},{emoji:"ğŸŠ",en:"swim",ja:"ãŠã‚ˆã"},{emoji:"ğŸ˜‹",en:"eat",ja:"ãŸã¹ã‚‹"},{emoji:"ğŸ˜´",en:"sleep",ja:"ã­ã‚‹"},{emoji:"ğŸ˜„",en:"laugh",ja:"ã‚ã‚‰ã†"},{emoji:"ğŸ˜¢",en:"cry",ja:"ãªã"},{emoji:"ğŸ“–",en:"read",ja:"ã‚ˆã‚€"},{emoji:"âœï¸",en:"write",ja:"ã‹ã"},{emoji:"ğŸ¤",en:"sing",ja:"ã†ãŸã†"},{emoji:"ğŸ’ƒ",en:"dance",ja:"ãŠã©ã‚‹"},{emoji:"ğŸ‘",en:"clap",ja:"ã¦ã‚’ãŸãŸã"}],adjectives:[{emoji:"ğŸ‘",en:"good",ja:"ã‚ˆã„"},{emoji:"ğŸ˜",en:"sad",ja:"ã‹ãªã—ã„"},{emoji:"ğŸ˜„",en:"happy",ja:"ã†ã‚Œã—ã„"},{emoji:"ğŸ˜ ",en:"angry",ja:"ãŠã“ã£ãŸ"},{emoji:"ğŸ˜",en:"big",ja:"ãŠãŠãã„"},{emoji:"ğŸ­",en:"small",ja:"ã¡ã„ã•ã„"},{emoji:"ğŸ”¥",en:"hot",ja:"ã‚ã¤ã„"},{emoji:"ğŸ¥¶",en:"cold",ja:"ã•ã‚€ã„"},{emoji:"ğŸ°",en:"fast",ja:"ã¯ã‚„ã„"},{emoji:"ğŸ¢",en:"slow",ja:"ãŠãã„"}],body:[{emoji:"ğŸ‘€",en:"eye",ja:"ã‚"},{emoji:"ğŸ‘ƒ",en:"nose",ja:"ã¯ãª"},{emoji:"ğŸ‘„",en:"mouth",ja:"ãã¡"},{emoji:"ğŸ‘‚",en:"ear",ja:"ã¿ã¿"},{emoji:"ğŸ‘‹",en:"hand",ja:"ã¦"},{emoji:"ğŸ¦¶",en:"foot",ja:"ã‚ã—"},{emoji:"ğŸ™‚",en:"face",ja:"ã‹ãŠ"},{emoji:"ğŸ’ª",en:"arm",ja:"ã†ã§"}],family:[{emoji:"ğŸ‘¨",en:"father",ja:"ãŠã¨ã†ã•ã‚“"},{emoji:"ğŸ‘©",en:"mother",ja:"ãŠã‹ã‚ã•ã‚“"},{emoji:"ğŸ‘¦",en:"boy",ja:"ãŠã¨ã“ã®ã“"},{emoji:"ğŸ‘§",en:"girl",ja:"ãŠã‚“ãªã®ã“"},{emoji:"ğŸ‘¶",en:"baby",ja:"ã‚ã‹ã¡ã‚ƒã‚“"},{emoji:"ğŸ§‘â€ğŸ¤â€ğŸ§‘",en:"friend",ja:"ã¨ã‚‚ã ã¡"}],nature:[{emoji:"â˜€ï¸",en:"sun",ja:"ãŸã„ã‚ˆã†"},{emoji:"ğŸŒ™",en:"moon",ja:"ã¤ã"},{emoji:"â­",en:"star",ja:"ã»ã—"},{emoji:"ğŸŒ¸",en:"flower",ja:"ã¯ãª"},{emoji:"ğŸŒ³",en:"tree",ja:"ã"},{emoji:"â˜ï¸",en:"cloud",ja:"ãã‚‚"},{emoji:"ğŸ’§",en:"rain",ja:"ã‚ã‚"},{emoji:"ğŸŒŠ",en:"sea",ja:"ã†ã¿"}],weather:[{emoji:"â˜€ï¸",en:"sunny",ja:"ã¯ã‚Œ"},{emoji:"â˜ï¸",en:"cloudy",ja:"ãã‚‚ã‚Š"},{emoji:"â˜”",en:"rainy",ja:"ã‚ã‚"},{emoji:"â˜ƒï¸",en:"snowy",ja:"ã‚†ã"},{emoji:"ğŸŒ¬ï¸",en:"windy",ja:"ã‹ãœ"},{emoji:"ğŸŒˆ",en:"rainbow",ja:"ã«ã˜"}],clothes:[{emoji:"ğŸ‘•",en:"shirt",ja:"ã‚·ãƒ£ãƒ„"},{emoji:"ğŸ‘–",en:"pants",ja:"ã‚ºãƒœãƒ³"},{emoji:"ğŸ‘—",en:"dress",ja:"ãƒ‰ãƒ¬ã‚¹"},{emoji:"ğŸ‘Ÿ",en:"shoes",ja:"ãã¤"},{emoji:"ğŸ§¢",en:"cap",ja:"ã¼ã†ã—"},{emoji:"ğŸ§¦",en:"socks",ja:"ãã¤ã—ãŸ"}],vehicles:[{emoji:"ğŸš—",en:"car",ja:"ã˜ã©ã†ã—ã‚ƒ"},{emoji:"ğŸšŒ",en:"bus",ja:"ãƒã‚¹"},{emoji:"ğŸš†",en:"train",ja:"ã§ã‚“ã—ã‚ƒ"},{emoji:"âœˆï¸",en:"airplane",ja:"ã²ã“ã†ã"},{emoji:"ğŸš¢",en:"ship",ja:"ãµã­"},{emoji:"ğŸš²",en:"bicycle",ja:"ã˜ã¦ã‚“ã—ã‚ƒ"}],places:[{emoji:"ğŸ ",en:"house",ja:"ã„ãˆ"},{emoji:"ğŸ«",en:"school",ja:"ãŒã£ã“ã†"},{emoji:"ğŸï¸",en:"park",ja:"ã“ã†ãˆã‚“"},{emoji:"ğŸ¥",en:"hospital",ja:"ã³ã‚‡ã†ã„ã‚“"},{emoji:"ğŸ¦",en:"bank",ja:"ãã‚“ã“ã†"},{emoji:"ğŸ—¼",en:"tower",ja:"ã‚¿ãƒ¯ãƒ¼"}],jobs:[{emoji:"ğŸ§‘â€âš•ï¸",en:"doctor",ja:"ã„ã—ã‚ƒ"},{emoji:"ğŸ‘®",en:"police officer",ja:"ã‘ã„ã•ã¤ã‹ã‚“"},{emoji:"ğŸ§‘â€ğŸš’",en:"firefighter",ja:"ã—ã‚‡ã†ã¼ã†ã—"},{emoji:"ğŸ§‘â€ğŸ«",en:"teacher",ja:"ã›ã‚“ã›ã„"},{emoji:"ğŸ§‘â€ğŸ³",en:"chef",ja:"ã‚³ãƒƒã‚¯ã•ã‚“"}],insects:[{emoji:"ğŸ¦‹",en:"butterfly",ja:"ã¡ã‚‡ã†"},{emoji:"ğŸ",en:"ladybug",ja:"ã¦ã‚“ã¨ã†ã‚€ã—"},{emoji:"ğŸœ",en:"ant",ja:"ã‚ã‚Š"},{emoji:"ğŸ",en:"bee",ja:"ã¯ã¡"},{emoji:"ğŸ›",en:"caterpillar",ja:"ã„ã‚‚ã‚€ã—"}],sports:[{emoji:"âš½",en:"soccer",ja:"ã‚µãƒƒã‚«ãƒ¼"},{emoji:"âš¾",en:"baseball",ja:"ã‚„ãã‚…ã†"},{emoji:"ğŸ€",en:"basketball",ja:"ãƒã‚¹ã‚±"},{emoji:"ğŸ¾",en:"tennis",ja:"ãƒ†ãƒ‹ã‚¹"},{emoji:"ğŸŠ",en:"swimming",ja:"ã™ã„ãˆã„"}],instruments:[{emoji:"ğŸ¹",en:"piano",ja:"ãƒ”ã‚¢ãƒ"},{emoji:"ğŸ¸",en:"guitar",ja:"ã‚®ã‚¿ãƒ¼"},{emoji:"ğŸ¥",en:"drum",ja:"ãŸã„ã“"},{emoji:"ğŸº",en:"trumpet",ja:"ãƒˆãƒ©ãƒ³ãƒšãƒƒãƒˆ"},{emoji:"ğŸ»",en:"violin",ja:"ãƒã‚¤ã‚ªãƒªãƒ³"}],days:[{emoji:"ğŸ‡²",en:"Monday",ja:"ã’ã¤ã‚ˆã†ã³"},{emoji:"ğŸ‡¹",en:"Tuesday",ja:"ã‹ã‚ˆã†ã³"},{emoji:"ğŸ‡¼",en:"Wednesday",ja:"ã™ã„ã‚ˆã†ã³"},{emoji:"ğŸ‡¹",en:"Thursday",ja:"ã‚‚ãã‚ˆã†ã³"},{emoji:"ğŸ‡«",en:"Friday",ja:"ãã‚“ã‚ˆã†ã³"},{emoji:"ğŸ‡¸",en:"Saturday",ja:"ã©ã‚ˆã†ã³"},{emoji:"ğŸ‡¸",en:"Sunday",ja:"ã«ã¡ã‚ˆã†ã³"}],seasons:[{emoji:"ğŸŒ¸",en:"spring",ja:"ã¯ã‚‹"},{emoji:"â˜€ï¸",en:"summer",ja:"ãªã¤"},{emoji:"ğŸ‚",en:"fall",ja:"ã‚ã"},{emoji:"â˜ƒï¸",en:"winter",ja:"ãµã‚†"}],countries:[{emoji:"ğŸ‡¯ğŸ‡µ",en:"Japan",ja:"ã«ã»ã‚“"},{emoji:"ğŸ‡ºğŸ‡¸",en:"America",ja:"ã‚¢ãƒ¡ãƒªã‚«"},{emoji:"ğŸ‡¬ğŸ‡§",en:"England",ja:"ã‚¤ã‚®ãƒªã‚¹"},{emoji:"ğŸ‡¨ğŸ‡³",en:"China",ja:"ã¡ã‚…ã†ã”ã"}],directions:[{emoji:"â¬†ï¸",en:"up",ja:"ã†ãˆ"},{emoji:"â¬‡ï¸",en:"down",ja:"ã—ãŸ"},{emoji:"â¬…ï¸",en:"left",ja:"ã²ã ã‚Š"},{emoji:"â¡ï¸",en:"right",ja:"ã¿ã"}]};

        // --- ã‚¢ãƒ—ãƒªã®ãƒ­ã‚¸ãƒƒã‚¯ ---
        const categoryScreen=document.getElementById("category-screen"),flashcardScreen=document.getElementById("flashcard-screen"),card=document.getElementById("card"),nextButton=document.getElementById("next-card"),playPauseButton=document.getElementById("play-pause-button"),modeRadios=document.querySelectorAll('input[name="mode"]'),backButtons=document.querySelectorAll(".back-button");
        let learningMode="manual",currentWords=[],currentIndex=0,isAutoPlaying=!1,autoPlayTimer;
        
        let googleJaVoice = null, googleEnVoice = null;

        function setGoogleVoices() {
            const voices = window.speechSynthesis.getVoices();
            googleJaVoice = voices.find(v => v.name === 'Google æ—¥æœ¬èª') || voices.find(v => v.lang === 'ja-JP' && v.name.includes('Google'));
            googleEnVoice = voices.find(v => v.name === 'Google US English') || voices.find(v => v.lang === 'en-US' && v.name.includes('Google'));
        }

        setGoogleVoices();
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = setGoogleVoices;
        }
        
        // --- åˆæœŸåŒ–ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ ---
        function initialize() {
            modeRadios.forEach(t=>t.addEventListener("change",e=>{learningMode=e.target.value}));
            document.querySelectorAll(".category-button").forEach(t=>{t.addEventListener("click",()=>{currentCategory=t.dataset.category,currentWords=wordData[currentCategory],currentIndex=0,showScreen("flashcard-screen"),"manual"===learningMode?(card.classList.add("manual-mode"),playPauseButton.classList.add("hidden"),nextButton.classList.remove("hidden"),displayCard(),speak(currentWords[currentIndex].ja,"ja-JP")):(card.classList.remove("manual-mode"),isAutoPlaying=!0,playPauseButton.textContent="ã„ã¡ã˜ã¦ã„ã—",playPauseButton.classList.remove("hidden"),nextButton.classList.add("hidden"),autoPlayFlow())})});
            playPauseButton.addEventListener("click",toggleAutoPlay);
            card.addEventListener("click",()=>{if("manual"!==learningMode)return;const t=card.classList.contains("is-flipped"),e=currentWords[currentIndex];card.classList.toggle("is-flipped"),t?speak(e.ja,"ja-JP"):speak(e.en,"en-US")});
            nextButton.addEventListener("click",()=>{currentIndex++,currentIndex>=currentWords.length&&(currentIndex=0),displayCard(),speak(currentWords[currentIndex].ja,"ja-JP")});
            backButtons.forEach(t=>t.addEventListener("click",()=>{isAutoPlaying=!1,clearTimeout(autoPlayTimer),window.speechSynthesis.cancel(),showScreen("category-screen")}));
        }

        // --- ã‚³ã‚¢æ©Ÿèƒ½ ---
        function showScreen(t){categoryScreen.classList.add("hidden"),flashcardScreen.classList.add("hidden"),document.getElementById(t).classList.remove("hidden")}
        function displayCard(){const t=currentWords[currentIndex];document.getElementById("front-emoji").textContent=t.emoji,document.getElementById("front-text").textContent=t.ja,document.getElementById("back-text").textContent=t.en,card.classList.remove("is-flipped")}
        
        // â–¼â–¼â–¼ å¤‰æ›´ç®‡æ‰€ â–¼â–¼â–¼
        function speak(t, e, o){
            window.speechSynthesis.cancel();
            const n = new SpeechSynthesisUtterance(t);
            n.lang = e; // ã¾ãšè¨€èªã‚’è¨­å®š
            
            // iPhone/iPad/iPodãªã©ã®Appleè£½ãƒ¢ãƒã‚¤ãƒ«ç«¯æœ«ã‹åˆ¤åˆ¥
            const isAppleMobile = /iPhone|iPad|iPod/i.test(navigator.userAgent);

            // Appleè£½ç«¯æœ«ã§ãªã‘ã‚Œã°GoogleéŸ³å£°ã‚’æ¢ã™ã€‚
            // Appleè£½ç«¯æœ«ã®å ´åˆã¯ã€OSã«å£°ã®é¸æŠã‚’å®Œå…¨ã«ä»»ã›ã‚‹ï¼ˆSiriå“è³ªã®å£°ã‚’å„ªå…ˆã•ã›ã‚‹ãŸã‚ï¼‰ã€‚
            if (!isAppleMobile) {
                if (e === 'ja-JP' && googleJaVoice) {
                    n.voice = googleJaVoice;
                } else if (e === 'en-US' && googleEnVoice) {
                    n.voice = googleEnVoice;
                }
            }
            
            if ("function" == typeof o) n.onend = o;
            window.speechSynthesis.speak(n);
        }
        // â–²â–²â–² å¤‰æ›´ç®‡æ‰€ â–²â–²â–²
        
        function autoPlayFlow(){
            if(!isAutoPlaying||0===currentWords.length)return;
            displayCard();
            const t=currentWords[currentIndex];
            speak(t.ja,"ja-JP",()=>{
                if(!isAutoPlaying)return;
                autoPlayTimer=setTimeout(()=>{
                    card.classList.add("is-flipped");
                    speak(t.en,"en-US",()=>{
                        if(!isAutoPlaying)return;
                        currentIndex++;
                        if(currentIndex>=currentWords.length) currentIndex=0;
                        autoPlayTimer=setTimeout(autoPlayFlow,1e3);
                    });
                },1e3);
            });
        }
        
        function toggleAutoPlay(){
            isAutoPlaying=!isAutoPlaying;
            if(isAutoPlaying){
                playPauseButton.textContent="ã„ã¡ã˜ã¦ã„ã—";
                autoPlayFlow();
            } else {
                playPauseButton.textContent="ã•ã„ã›ã„";
                clearTimeout(autoPlayTimer);
                window.speechSynthesis.cancel();
            }
        }
        
        initialize();
    </script>
</body>
</html>